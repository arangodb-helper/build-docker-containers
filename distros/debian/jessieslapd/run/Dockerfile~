FROM debian:jessie
MAINTAINER Wilfried Goesgens <willi@arangodb.com>

# ARG HTTP_PROXY
# for local installation, uncomment
# ADD ./arangodb /install

run apt-get update && apt-get install -y aptitude && aptitude install -y htop vim
run export DEBIAN_FRONTEND=noninteractive && aptitude install -y slapd

run service slapd stop
run rm -rf /etc/ldap && rm -rf /var/lib/ldap && rm -rf /usr/share/slapd

copy ./ldap_conf  /etc/ldap
copy ./ldap_db    /var/lib/ldap
copy ./slapd_conf /usr/share/slapd
copy ./ca_server.pem   /etc/ssl/certs/ca_server.pem
copy ./ldap_server.pem /etc/ssl/certs/ldap_server.pem
copy ./ldap_server.key /etc/ssl/private/ldap_server.key
copy ./entrypoint.sh /entrypoint.sh

ENTRYPOINT ["/entrypoint.sh"]
